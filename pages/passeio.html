<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Passeio - VUMBORA</title>
  <meta name="description" content="Detalhes do passeio">
  <link href="../assets/css/style.css" rel="stylesheet">
  <link href="../assets/css/components.css" rel="stylesheet">
  <link href="../assets/css/sections.css" rel="stylesheet">
  <link href="../assets/css/passeios.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
</head>

<body class="icon-theme-primary">
  <!-- Header/Menu -->
  <div id="header"></div>

  <main>
    <div class="site-content">
      <!-- Seção de Detalhes do Passeio -->
      <section id="passeio-content"></section>
    </div>
  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Modal de Política de Cancelamento -->
  <div id="modal-politica-container"></div>

  <!-- Scripts -->
  <script src="../assets/js/config.js"></script>
  <script src="../assets/js/icons.js"></script>
  <script src="../assets/js/includes.js"></script>
  <script src="../assets/js/main.js"></script>
  <script src="../assets/js/passeios.js"></script>

  <script>
    // Garantir que PAGE_CONFIGS existe
    if (typeof window.PAGE_CONFIGS === 'undefined') {
      window.PAGE_CONFIGS = {};
    }
    // Atualizar configuração de páginas no includes.js
    window.PAGE_CONFIGS['passeio.html'] = [
      { id: 'passeio-content', path: '../sections/passeio-content.html' },
      { id: 'modal-politica-container', path: '../sections/modal-politica-cancelamento.html' }
    ];

    // Função para inicializar o passeio individual
    async function inicializarPasseio() {
      // Aguardar até que os elementos estejam no DOM
      let tentativas = 0;
      const maxTentativas = 50; // 5 segundos no total

      while (tentativas < maxTentativas) {
        const container = document.getElementById('passeio-content');
        const nomeElement = document.getElementById('passeio-nome');

        if (container && nomeElement) {
          // Elementos estão prontos, carregar dados
          if (typeof window.carregarPasseioIndividual === 'function') {
            await window.carregarPasseioIndividual();
            console.log('✅ Detalhes do passeio carregados!');
            return;
          } else {
            console.error('❌ Função carregarPasseioIndividual não encontrada');
            return;
          }
        }

        await new Promise(resolve => setTimeout(resolve, 100));
        tentativas++;
      }

      console.error('❌ Timeout ao aguardar elementos do passeio');
    }

    // Aguardar o evento contentLoaded do includes.js
    document.addEventListener('contentLoaded', (event) => {
      // Verificar se é a página de passeio
      if (event.detail.pageConfig &&
        event.detail.pageConfig.some(config => config.id === 'passeio-content')) {
        // Substituir emojis do conteúdo estático antes de carregar dados dinâmicos
        if (typeof window.replaceEmojisWithIconsGlobal === 'function') {
          // Múltiplas chamadas para garantir processamento
          setTimeout(() => {
            window.replaceEmojisWithIconsGlobal();
            setTimeout(() => {
              window.replaceEmojisWithIconsGlobal();
            }, 200);
          }, 100);
        }
        setTimeout(inicializarPasseio, 300);
      }
    });

    // Fallback caso o evento não seja disparado
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        const container = document.getElementById('passeio-content');
        if (container && container.children.length > 0) {
          inicializarPasseio();
        }
      }, 2000);
    });
  </script>
</body>

</html>