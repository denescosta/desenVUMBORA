<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nossos Passeios - VUMBORA</title>
  <meta name="description" content="Conhe√ßa todos os passeios e experi√™ncias incr√≠veis que oferecemos em Natal/RN">
  <link href="../assets/css/style.css" rel="stylesheet">
  <link href="../assets/css/components.css" rel="stylesheet">
  <link href="../assets/css/sections.css" rel="stylesheet">
  <link href="../assets/css/passeios.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
  <!-- Header/Menu -->
  <div id="header"></div>

  <main>
    <div class="site-content">
      <!-- Se√ß√£o de Cat√°logo -->
      <section id="catalogo-content"></section>
    </div>
  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Scripts -->
  <script src="../assets/js/includes.js"></script>
  <script src="../assets/js/passeios.js"></script>
  <script src="../assets/js/main.js"></script>

  <script>
    // Atualizar configura√ß√£o de p√°ginas no includes.js
    if (typeof PAGE_CONFIGS === 'undefined') {
      window.PAGE_CONFIGS = {};
    }
    PAGE_CONFIGS['catalogo.html'] = [
      { id: 'catalogo-content', path: '../sections/catalogo-content.html' }
    ];

    // Fun√ß√£o para inicializar cat√°logo quando o conte√∫do estiver pronto
    async function inicializarCatalogo() {
      console.log('üîÑ Iniciando carregamento do cat√°logo...');

      // Aguardar at√© que o container exista (includes.js carregou o conte√∫do)
      let container = document.getElementById('catalogo-lista');
      let tentativas = 0;
      const maxTentativas = 100; // 10 segundos no total

      while (!container && tentativas < maxTentativas) {
        await new Promise(resolve => setTimeout(resolve, 100));
        container = document.getElementById('catalogo-lista');
        tentativas++;
        if (tentativas % 10 === 0) {
          console.log('‚è≥ Aguardando container catalogo-lista...', tentativas);
        }
      }

      // Verificar se o container foi encontrado
      if (!container) {
        console.error('‚ùå Container catalogo-lista n√£o encontrado ap√≥s', tentativas, 'tentativas');
        return;
      }

      console.log('‚úÖ Container encontrado!');

      // Aguardar at√© que a fun√ß√£o esteja dispon√≠vel
      tentativas = 0;
      while (typeof window.carregarCatalogoPasseios !== 'function' && tentativas < maxTentativas) {
        await new Promise(resolve => setTimeout(resolve, 100));
        tentativas++;
      }

      if (typeof window.carregarCatalogoPasseios !== 'function') {
        console.error('‚ùå Fun√ß√£o carregarCatalogoPasseios n√£o encontrada ap√≥s', tentativas, 'tentativas');
        container.innerHTML = '<p class="no-results">Erro: Fun√ß√£o de carregamento n√£o dispon√≠vel. Verifique se passeios.js foi carregado.</p>';
        return;
      }

      console.log('‚úÖ Fun√ß√£o encontrada! Carregando passeios...');

      // Carregar cat√°logo SEM filtro (todos os passeios)
      try {
        await window.carregarCatalogoPasseios(null);
        console.log('‚úÖ Cat√°logo de passeios carregado!');
      } catch (error) {
        console.error('‚ùå Erro ao carregar cat√°logo:', error);
        container.innerHTML = '<p class="no-results">Erro ao carregar passeios. Tente recarregar a p√°gina.</p>';
      }
    }

    // Ouvir evento de conte√∫do carregado
    document.addEventListener('contentLoaded', (event) => {
      console.log('üì¶ Evento contentLoaded disparado!', event.detail);
      // Verificar se √© a p√°gina de cat√°logo
      if (event.detail.pageConfig &&
        event.detail.pageConfig.some(config => config.id === 'catalogo-content')) {
        console.log('‚úÖ Conte√∫do do cat√°logo carregado, iniciando...');
        setTimeout(inicializarCatalogo, 200);
      }
    });

    // Fun√ß√£o fallback caso o evento n√£o seja disparado
    function iniciarQuandoPronto() {
      console.log('üîç Verificando se scripts est√£o prontos...');

      // Verificar se todos os scripts necess√°rios est√£o carregados
      if (typeof window.PAGE_CONFIGS === 'undefined') {
        console.log('‚è≥ Aguardando PAGE_CONFIGS...');
        setTimeout(iniciarQuandoPronto, 100);
        return;
      }

      if (typeof window.passeiosManager === 'undefined') {
        console.log('‚è≥ Aguardando passeiosManager...');
        setTimeout(iniciarQuandoPronto, 100);
        return;
      }

      if (typeof window.carregarCatalogoPasseios !== 'function') {
        console.log('‚è≥ Aguardando carregarCatalogoPasseios...');
        setTimeout(iniciarQuandoPronto, 100);
        return;
      }

      console.log('‚úÖ Todos os scripts est√£o prontos!');

      // Aguardar um pouco para includes.js carregar o conte√∫do HTML
      // Se ap√≥s 2 segundos o evento n√£o disparou, tenta mesmo assim
      setTimeout(() => {
        const container = document.getElementById('catalogo-lista');
        if (container) {
          console.log('üîÑ Fallback: Container encontrado, iniciando carregamento...');
          inicializarCatalogo();
        }
      }, 2000);
    }

    // Iniciar quando DOM estiver pronto
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        console.log('üìÑ DOM carregado, iniciando verifica√ß√£o...');
        iniciarQuandoPronto();
      });
    } else {
      console.log('üìÑ DOM j√° carregado, iniciando verifica√ß√£o...');
      iniciarQuandoPronto();
    }
  </script>
</body>

</html>