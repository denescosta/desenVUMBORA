<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nossos Passeios - VUMBORA</title>
  <meta name="description" content="Conheça todos os passeios e experiências incríveis que oferecemos em Natal/RN">
  <link href="../assets/css/style.css" rel="stylesheet">
  <link href="../assets/css/components.css" rel="stylesheet">
  <link href="../assets/css/sections.css" rel="stylesheet">
  <link href="../assets/css/passeios.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
  <!-- Header/Menu -->
  <div id="header"></div>

  <main>
    <div class="site-content">
      <!-- Seção de Catálogo -->
      <section id="catalogo-content"></section>
    </div>
  </main>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Scripts -->
  <script src="../assets/js/config.js"></script>
  <script src="../assets/js/includes.js"></script>
  <script src="../assets/js/passeios.js"></script>
  <script src="../assets/js/main.js"></script>

  <script>
    // Garantir que PAGE_CONFIGS existe (caso includes.js ainda não tenha carregado)
    if (typeof window.PAGE_CONFIGS === 'undefined') {
      window.PAGE_CONFIGS = {};
    }
    // Atualizar configuração de páginas (já está no includes.js, mas garantir)
    window.PAGE_CONFIGS['catalogo.html'] = [
      { id: 'catalogo-content', path: '../sections/catalogo-content.html' }
    ];

    // Função para inicializar catálogo quando o conteúdo estiver pronto
    async function inicializarCatalogo() {
      // Aguardar até que o container exista (includes.js carregou o conteúdo)
      let container = document.getElementById('catalogo-lista');
      let tentativas = 0;
      const maxTentativas = 100; // 10 segundos no total

      while (!container && tentativas < maxTentativas) {
        await new Promise(resolve => setTimeout(resolve, 100));
        container = document.getElementById('catalogo-lista');
        tentativas++;
      }

      // Verificar se o container foi encontrado
      if (!container) {
        console.error('❌ Container catalogo-lista não encontrado');
        return;
      }

      // Aguardar até que a função esteja disponível
      tentativas = 0;
      while (typeof window.carregarCatalogoPasseios !== 'function' && tentativas < maxTentativas) {
        await new Promise(resolve => setTimeout(resolve, 100));
        tentativas++;
      }

      if (typeof window.carregarCatalogoPasseios !== 'function') {
        console.error('❌ Função carregarCatalogoPasseios não encontrada');
        container.innerHTML = '<p class="no-results">Erro: Função de carregamento não disponível. Verifique se passeios.js foi carregado.</p>';
        return;
      }

      // Carregar catálogo SEM filtro (todos os passeios)
      try {
        await window.carregarCatalogoPasseios(null);
      } catch (error) {
        console.error('❌ Erro ao carregar catálogo:', error);
        container.innerHTML = '<p class="no-results">Erro ao carregar passeios. Tente recarregar a página.</p>';
      }
    }

    // Ouvir evento de conteúdo carregado
    document.addEventListener('contentLoaded', (event) => {
      // Verificar se é a página de catálogo
      if (event.detail.pageConfig &&
        event.detail.pageConfig.some(config => config.id === 'catalogo-content')) {
        setTimeout(inicializarCatalogo, 200);
      }
    });

    // Função fallback caso o evento não seja disparado
    function iniciarQuandoPronto() {
      // Verificar se os scripts necessários estão carregados
      if (typeof window.passeiosManager === 'undefined') {
        setTimeout(iniciarQuandoPronto, 100);
        return;
      }

      if (typeof window.carregarCatalogoPasseios !== 'function') {
        setTimeout(iniciarQuandoPronto, 100);
        return;
      }

      // Aguardar um pouco para includes.js carregar o conteúdo HTML
      // Se após 2 segundos o evento não disparou, tenta mesmo assim
      setTimeout(() => {
        const container = document.getElementById('catalogo-lista');
        if (container) {
          inicializarCatalogo();
        }
      }, 2000);
    }

    // Iniciar quando DOM estiver pronto (apenas como fallback)
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', iniciarQuandoPronto);
    } else {
      iniciarQuandoPronto();
    }
  </script>
</body>

</html>